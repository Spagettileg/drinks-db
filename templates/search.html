{% extends 'base.html' %} {% block content %}

<div class="container content-wrapper">

    <!--Page Title-->
    <div class="row center">
        <h4>Search</h4>
        <hr>
    </div>

    <div class="row">
        <form action="{{ url_for('search') }}" class="col s12 xl10 offset-xl1">
            <span><i class="fas fa-search"></i></span>
            <!--Search-->
            <div class="input-field">
                {%if find %}
                <input placeholder="Last Search: {{find}}" id="find" name="find" type="text">
                {%else %}
                <input placeholder="Leave blank to return all drinks" id="find" name="find" type="text">
                {% endif %}
                <label for "find">Search</label>
            </div>
            <!--Filters-->
            <div class="row">
                <div class="input-field col s4">
                    <select id="category_filter" name="category_filter">
                        <option value="" selected>No Filter</option>
                        {% for item in all_categories %}
                            {% if item.category == category_filter %}
                            <option value="{{ item.category }}" selected>{{ item.category.title() }}</option>
                            {% else %}
                            <option value="{{ item.category }}">{{ item.category.title() }}</option>
                            {% endif %}
                        {% endfor %}
                        </select>
                    <label for="category_filter">Filter By Category</label>
                </div>
                <div class="input-field col s4">
                    <select id="glassType_filter" name="glassType_filter">
                        <option value="" selected>No Filter</option>
                        {% for item in all_glass_types %}
                            {% if item.glassType == glassType_filter %}
                            <option value="{{ item.glassType }}" selected>{{ item.glassType.title() }}</option>
                            {% else %}
                            <option value="{{ item.glassType }}">{{ item.glassType.title() }}</option>
                            {% endif %}
                        {% endfor %}
                    </select>
                    <label for="glassType_filter">Filter By Glass Type</label>
                </div>
                <div class="input-field col s4">
                    <select id="difficulty_filter" name="difficulty_filter">
                        <option value="" selected>No Filter</option>
                        {% for item in all_difficulties %}
                            {% if item.difficulty == difficulty_filter %}
                            <option value="{{ item.difficulty }}" selected>{{ item.difficulty.title() }}</option>
                            {% else %}
                            <option value="{{ item.difficulty }}">{{ item.difficulty.title() }}</option>
                            {% endif %}
                        {% endfor %}
                    </select>
                    <label for="difficulty_filter">Filter By Difficulty</label>
                </div>
            </div>
            <!--Send / Cancel Buttons-->
            <div class="center">
                <button class="waves-effect waves-light btn" type="submit"><i class="material-icons right">send</i>Send</button>
                <a class="waves-effect waves-light btn" href="{{ url_for('search') }}"><i class="material-icons right">cancel</i>reset</a>
            </div>
        </form>
    </div>
    <br>
    <br>

    <!--No results from search-->
    {% if num_results == 0 %}
    <h5 class="center">No drinks found for '{{find}}'. Please try another search.</h5>
    {% endif %}
    
    <!--Display Results-->
    {% if results %}
    <!--Sort Options-->
    <div class="sort-options-title center">
        <h5>Browse Sorting Options.</h5>
        <a id="sort-options-btn" class="waves-effect waves-light btn-small">Sort Options</a>
    </div>
    <br>
    <div id="sort-options" class="row hidden">
        <form method="POST" action="{{ url_for('search',
            current_page=page_number,
            find=find,
            category_filter=category_filter,
            glassType_filter=glassType_filter,
            difficulty_filter=difficulty_filter)}}">
            {% include 'helpers/sort_options.html' %}
        </form>
    </div>

    <div class="row center">
        <h5>Search Results</h5>
        <h6>Showing {{first_result_num}} - {{last_result_num}} of {{results.count()}} results</h6>
    </div>

    <div class="row">
        {% for drink in results %}
        <div class="col s6 l4 xl3 border-outline center">
            {% include 'helpers/drink_card.html' %}
        </div>
        {% endfor %}
    </div>

    <!--Pagination-->
    <ul class="pagination center">
        <!--Left Arrow-->
        {% if current_page | int > 1 %}
        <li class=""><a href="{{ url_for('search',
            current_page=current_page-1,
            find=find,
            category_filter=category_filter,
            glassType_filter=glassType_filter,
            difficulty_filter=difficulty_filter) }}"><i class="material-icons">arrow_left</i></a></li>
        {% else %}
        <li class="disabled"><i class="material-icons">arrow_left</i></li>
        {% endif %}

        <!--Page Numbers-->
        {% for page_number in pages %} {% if page_number == current_page %}
        <li class="active"><a>{{ page_number }}</a></li>
        {% else %}
        <li class="waves-effect"><a href="{{ url_for('search',
            current_page=page_number,
            find=find,
            category_filter=category_filter,
            glassType_filter=glassType_filter,
            difficulty_filter=difficulty_filter) }}">{{ page_number }}</a></li>
        {% endif %} {% endfor %}

        <!--Right Arrow-->
        {% if current_page | int
        < pages | count | int %} <li class=""><a href="{{ url_for('search',
            current_page=current_page+1,
            find=find,
            category_filter=category_filter,
            glassType_filter=glassType_filter,
            difficulty_filter=difficulty_filter) }}"><i class="material-icons">arrow_right</i></a></li>
            {% else %}
            <li class="disabled"><i class="material-icons">arrow_right</i></li>
            {% endif %}
    </ul>
    {% endif %}

</div>

{% endblock %}
